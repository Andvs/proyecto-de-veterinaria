{% extends "inicio.html" %}
{% block main %}
<div class="container py-3" style="max-width: 800px;">
    <h4 class="mb-3">{{ titulo }}</h4>
    
    <div class="card shadow-sm mb-3">
        <div class="card-header bg-info text-white">
            <h5 class="mb-0">Información de la Cita</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Mascota:</strong> {{ cita.mascota.nombre }} ({{ cita.mascota.especie }})</p>
                    <p><strong>Dueño:</strong> {{ cita.mascota.dueno }}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Fecha Cita:</strong> {{ cita.fecha_hora|date:"d/m/Y H:i" }}</p>
                    <p><strong>Motivo:</strong> {{ cita.motivo }}</p>
                </div>
            </div>
        </div>
    </div>

    {% if form.non_field_errors %}
        <div class="alert alert-danger" role="alert">
            {{ form.non_field_errors }}
        </div>
    {% endif %}

    <div class="card shadow-sm">
        <div class="card-body">
        <form method="post" novalidate>
            {% csrf_token %}
            
            <div class="mb-3">
                <label for="id_fecha_consulta" class="form-label">Fecha de consulta</label>
                {{ form.fecha_consulta }}
                {% if form.fecha_consulta.errors %}
                    <div class="text-danger small mt-1">{{ form.fecha_consulta.errors }}</div>
                {% endif %}
            </div>
            
            <div class="mb-3">
                <label for="id_diagnostico" class="form-label">Diagnóstico *</label>
                {{ form.diagnostico }}
                {% if form.diagnostico.errors %}
                    <div class="text-danger small mt-1">{{ form.diagnostico.errors }}</div>
                {% endif %}
            </div>
            
            <div class="mb-3">
                <label for="id_tratamiento" class="form-label">Tratamiento prescrito</label>
                {{ form.tratamiento }}
                {% if form.tratamiento.errors %}
                    <div class="text-danger small mt-1">{{ form.tratamiento.errors }}</div>
                {% endif %}
            </div>
            
            <div class="mb-3">
                <label for="id_medicamentos" class="form-label">Medicamentos</label>
                {{ form.medicamentos }}
                {% if form.medicamentos.errors %}
                    <div class="text-danger small mt-1">{{ form.medicamentos.errors }}</div>
                {% endif %}
                <small class="text-muted">Indica nombre, dosis y frecuencia</small>
            </div>
            
            <div class="mb-3">
                <label for="id_proxima_cita" class="form-label">Próxima cita (opcional)</label>
                {{ form.proxima_cita }}
                {% if form.proxima_cita.errors %}
                    <div class="text-danger small mt-1">{{ form.proxima_cita.errors }}</div>
                {% endif %}
                <small class="text-muted">
                    <i class="bi bi-info-circle"></i> Si especificas una fecha, se agendará automáticamente una cita de seguimiento a las 10:00 AM con el mismo veterinario
                </small>
            </div>
            
            <div class="mb-3">
                <label for="id_costo" class="form-label">Costo de consulta *</label>
                {{ form.costo }}
                {% if form.costo.errors %}
                    <div class="text-danger small mt-1">{{ form.costo.errors }}</div>
                {% endif %}
                <small class="text-muted">Entre $5,000 y $200,000</small>
            </div>
            
            <div class="d-flex gap-2 mt-3">
                <button class="btn btn-success" type="submit">
                    <i class="bi bi-check-circle"></i> Guardar Consulta
                </button>
                <a class="btn btn-outline-secondary" href="{% url 'cita_detalle' cita.id %}">
                    <i class="bi bi-x-circle"></i> Cancelar
                </a>
            </div>
        </form>
        </div>
    </div>
</div>
{% endblock %}